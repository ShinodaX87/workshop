<!DOCTYPE html>
<html lang="en" dir="ltr">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">

    <title>D3 Map</title>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <link rel="stylesheet" href="assets/css/styles.css">
  </head>

  <body>
    <h1>D3 Map</h1>
    <div id="map"></div>
    <script type="text/javascript">
      // IIFE - Pattern (Immediate Invoked Function Expression)
      (function() {
        'use strict';
        //  - - - - - - - - - -
        var
          svg,
          location,
          projection,
          path,
          features;

        svg = d3.select('#map')
          .append('svg')
          .attr('width', 500)
          .attr('height', 500);

        // map projection method
        // projection = d3.geoMercator() // since d3 v4
        projection = d3.geo.mercator(); // d3 v3

        //path = d3.geoPath().projection(projection);
        path = d3.geo.path().projection(projection);

        // D3 Map
        features = svg.append('g').classed('features', true);

        d3.json('assets/data/bundeslaender_simplify200.geojson', function(err, data) {

          // error handling
          if (err) throw err;

          let
            boundary = path.bounds(data),
            // left, right, top, bottom max values from map data?
            // translate the world clipping into canvas
            s = 0.95 / Math.max((boundary[1][0]) / 500, (boundary[1][1] - boundary[0][1]) / 500),
            t = [(500 - s * (boundary[1][0])) / 2, (500 - s * (boundary[1][1] - boundary[0][1])) / 2];

          projection
            .scale(s)
            .translate(t)

          // draw!
          features.selectAll('path')
            .data(data.features)
            .enter()
            .append('path')
            .attr('d', path)
            .attr('style', 'stroke:black;stroke-width:1px;');

        });

        //  - - - - - - - - - -
      })();
    </script>
  </body>

</html>